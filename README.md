# Configuración de la Agencia Web

Este proyecto utiliza **React** (Frontend), **Supabase** (Base de datos y Autenticación) y **Cloudinary** (Almacenamiento de imágenes).

## 1. Configuración de Supabase (SOLUCIÓN DE PERMISOS)

Para que la aplicación funcione correctamente (crear, editar, borrar), debes ejecutar este script en el **SQL Editor** de Supabase.

**Copia y pega TODO este bloque y ejecútalo:**

```sql
-- 1. Crear la tabla si no existe
create table if not exists posts (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  title text not null,
  summary text,
  content text not null,
  image_url text,
  slug text unique
);

-- 2. DESACTIVAR RLS (Seguridad a nivel de fila)
-- Al ser un admin único, esto evita bloqueos complejos de políticas
ALTER TABLE posts DISABLE ROW LEVEL SECURITY;

-- 3. OTORGAR PERMISOS (CRÍTICO)
-- Esto asegura que la API tenga permiso físico de escribir y borrar en la tabla
GRANT ALL ON TABLE posts TO anon;
GRANT ALL ON TABLE posts TO authenticated;
GRANT ALL ON TABLE posts TO service_role;

-- 4. ARREGLAR CONTADOR DE IDs
-- Evita errores al crear nuevos posts si borraste los anteriores
GRANT USAGE, SELECT ON SEQUENCE posts_id_seq TO anon, authenticated, service_role;

-- 5. URLS AMIGABLES
-- Asegurar que existe la columna slug
ALTER TABLE posts ADD COLUMN IF NOT EXISTS slug text;
```

### Configurar Autenticación (Login)
1. Ve a **Authentication** -> **Providers**. Asegúrate de que **Email** esté habilitado.
2. Ve a **Authentication** -> **Users** y crea un nuevo usuario (este será tu admin).

---

## 2. Configuración de Cloudinary

1. Ve a tu panel de Cloudinary -> **Settings** -> **Upload**.
2. En **Upload presets**, añade uno nuevo.
3. **IMPORTANTE:** En "Signing Mode", selecciona **Unsigned**.
4. En "Upload preset name", escribe: `blog_upload`.

---

## 3. Cómo poner la aplicación en marcha (LOCAL)

Sigue estos pasos para trabajar en tu ordenador:

1.  **Instalar Node.js:** Asegúrate de tenerlo instalado.
2.  **Abrir Terminal:** Abre la carpeta del proyecto en tu terminal o VS Code.
3.  **Instalar Dependencias:**
    ```bash
    npm install
    ```
4.  **Iniciar Servidor:**
    ```bash
    npm run dev
    ```
5.  **Ver:** Abre `http://localhost:3000` en tu navegador.

---

## 4. Cómo desplegar en GitHub Pages (GRATIS)

Para que el mundo vea tu web:

1.  **Crear Repositorio:** Crea un repo en GitHub y sube este código. Para despliegue gratuito, el repo debe ser **público**. Si necesitas mantenerlo privado, ver las instrucciones abajo.

2.  **Configurar GitHub Pages:** Ve a Settings -> Pages, selecciona "Deploy from a branch" como source, luego elige la rama `gh-pages` y carpeta `/(root)`.

3.  **Configurar Base (opcional):** Si tu repo no está en la raíz (ej. https://usuario.github.io/repo/), edita `vite.config.ts` y añade:

    ```typescript
    base: '/NOMBRE_REPO/',
    ```

    Dentro del return del defineConfig.

4.  **Desplegar:** El despliegue se hace automáticamente cuando pushes a la rama main. El workflow en `.github/workflows/deploy.yml` se encarga de construir y desplegar.

5.  **Configurar Router:** Como esta app usa `HashRouter`, funcionará perfectamente en GitHub Pages.

### Para repositorios privados (requiere GitHub Pro o superior)

Si tu repo es privado:

1. Crea un Personal Access Token (PAT) en GitHub: Ve a Settings -> Developer settings -> Personal access tokens -> Tokens (classic), genera uno con permisos `repo`.

2. En tu repo, ve a Settings -> Secrets and variables -> Actions, añade un nuevo secret llamado `GH_PAT` con el valor del token.

3. El workflow usará automáticamente el PAT para despliegues privados.