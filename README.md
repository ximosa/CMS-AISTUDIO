# Configuración de la Agencia Web

Este proyecto utiliza **React** (Frontend), **Supabase** (Base de datos y Autenticación) y **Cloudinary** (Almacenamiento de imágenes).

## 1. Configuración de Supabase

### A. Crear la Tabla
Ve al **SQL Editor** en tu panel de Supabase y ejecuta el siguiente script para crear la tabla necesaria (si no la tienes):

```sql
create table if not exists posts (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  title text not null,
  summary text,
  content text not null,
  image_url text
);
```

### B. Configurar Autenticación (Login)
1. Ve a **Authentication** -> **Providers**.
2. Asegúrate de que **Email** esté habilitado.
3. Ve a **Authentication** -> **Users** y crea un nuevo usuario (este será tu admin).

### C. Configurar Permisos (RLS) - **IMPORTANTE**
Ejecuta este script completo en el **SQL Editor**. Este script **borra** las reglas antiguas primero para evitar el error de "policy already exists" y luego crea las nuevas.

```sql
-- 1. Activar seguridad RLS
alter table posts enable row level security;

-- 2. LIMPIEZA: Borrar políticas antiguas si existen (evita el error 42710)
drop policy if exists "Public posts are viewable by everyone" on posts;
drop policy if exists "Authenticated users can manage posts" on posts;

-- 3. Crear política: TODO EL MUNDO puede VER (Select)
create policy "Public posts are viewable by everyone"
on posts for select
to anon, authenticated
using ( true );

-- 4. Crear política: SOLO ADMIN puede GESTIONAR (Insert, Update, Delete)
create policy "Authenticated users can manage posts"
on posts for all
to authenticated
using ( true )
with check ( true );
```

## 2. Configuración de Cloudinary

El sistema utiliza una carga "sin firmar" (Unsigned) para subir imágenes directamente desde el navegador.

1. Ve a tu panel de Cloudinary -> **Settings** (Engranaje) -> **Upload**.
2. Baja a la sección **Upload presets**.
3. Haz clic en **Add upload preset**.
4. **IMPORTANTE:** En "Signing Mode", selecciona **Unsigned**.
5. En "Upload preset name", escribe: `blog_upload`.
   * *Si pones otro nombre, debes cambiar la constante `CLOUDINARY_UPLOAD_PRESET` en los archivos `src/pages/Admin.tsx` y `src/components/RichTextEditor.tsx`*.
6. Guarda los cambios.

## 3. Variables de Entorno y Despliegue

Para producción, asegúrate de configurar la URL de tu proyecto Supabase y las claves en `src/supabaseClient.ts` (o usa variables de entorno `.env` si configuras un build process compatible).

### Comandos
- `npm start`: Iniciar desarrollo.
- `npm run build`: Crear versión de producción.